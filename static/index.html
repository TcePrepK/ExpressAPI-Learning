<!DOCTYPE html>
<html>
    <head>
        <title>Test Login Form</title>
    </head>
    <body>
        <!-- user input-->
        Recipe:<br />
        <input type="text" name="input1" placeholder="" /><br /><br />
        <input type="text" name="input2" placeholder="" /><br /><br />
        <input type="text" name="output" placeholder="" /><br /><br />
        <input type="submit" name="repDone" value="repDone" /><br /><br />
        Operation:<br />
        <input type="text" name="token" placeholder="" /><br /><br />
        <input type="text" name="operation" placeholder="" /><br /><br />
        <input type="text" name="id" placeholder="" /><br /><br />
        <input type="submit" name="opDone" value="opDone" /><br /><br />
        <!-- submit button -->
        <script>
            // import fetch from "node-fetch";

            function fetchFunction(path, request) {
                fetch("http://localhost:3000/" + path, {
                    method: "POST",
                    body: JSON.stringify(request), // The data
                    headers: {
                        "Content-Type": "application/json", // The type of data you're sending
                    },
                })
                    .then(res => {
                        if (res.status !== 200) {
                            throw "bad-status: " + res.status + " / " + res.statusText;
                        }

                        return res.text();
                    })
                    .then(result => {
                        console.log(result);
                    })
                    .catch(err => {
                        // handle error
                        console.error(err);
                    });
            }

            function addRecipeRequest(input1, input2, output) {
                fetchFunction("addRecipeRequest", { input1, input2, output });
            }

            function operateRecipeRequest(token, operation, id) {
                fetchFunction("operateRecipeRequest", { token, operation, id });
            }

            const input1 = document.getElementsByName("input1")[0];
            const input2 = document.getElementsByName("input2")[0];
            const output = document.getElementsByName("output")[0];

            const token = document.getElementsByName("token")[0];
            const operation = document.getElementsByName("operation")[0];
            const id = document.getElementsByName("id")[0];

            const submit1 = document.getElementsByName("repDone")[0];
            const submit2 = document.getElementsByName("opDone")[0];

            submit1.onclick = () => {
                console.log("Test1");
                if (input1.value == "") return;
                if (input2.value == "") return;
                if (output.value == "") return;
                console.log("Submit1");
                addRecipeRequest(input1.value, input2.value, output);
            };

            submit2.onclick = () => {
                console.log("Test2");
                if (token.value == "") return;
                if (operation.value == "") return;
                if (id.value == "") return;
                console.log("Submit2");
                operateRecipeRequest(token.value, Boolean(operation.value), id.value);
            };
        </script>
    </body>
</html>
